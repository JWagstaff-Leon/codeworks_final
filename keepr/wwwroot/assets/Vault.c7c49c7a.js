import{M as k,j as b,u as I,z as M,c,a as y,o,b as n,d as l,t as V,i,F as x,l as B,e as L,k as P,f as S,p as j,m as F}from"./vendor.d2861f43.js";import{_ as N,A as a,l as m,v as w,k as U,P as u}from"./index.c39ce0d3.js";import{L as E}from"./Loader.7531e362.js";const O={async mounted(){await this.mountedFunc()},beforeUnmount(){this.resetPage()},watch:{openModal(t){t?k.getOrCreateInstance(document.getElementById("keep-modal")).show():k.getOrCreateInstance(document.getElementById("keep-modal")).hide()},"route.params.id"(t){t&&this.route.name=="Vault"&&(this.resetPage(),this.mountedFunc())}},setup(){const t=b(),r=I(),p=M(!0);return{route:t,loading:p,resetPage:()=>{a.activeVault=null,a.activeKeeps=null,a.openModal=!1},vault:c(()=>a.activeVault),keeps:c(()=>a.activeKeeps),filteredKeeps:c(()=>{var e;return(e=a.activeKeeps)==null?void 0:e.filter(h=>h.name.toLowerCase().includes(a.searchTerm.toLowerCase()))}),isUsersVault:c(()=>{var e;return a.account.id===((e=a.activeVault)==null?void 0:e.creatorId)}),openModal:c(()=>a.openModal),async mountedFunc(){try{this.loading=!0,a.searchTerm="",this.resetPage();const e=new E;m.log("Loading"),e.step(w.getById,[this.route.params.id]),e.step(U.getByVault,[this.route.params.id]),await e.load(),this.loading=!1}catch(e){this.loading=!1,m.error("[Vault.vue > mountedFunc]",e.message),r.push({name:"Home"}),await u.confirm("You do not have permission to view this vault","You have been redirected to the home page","info","Okay",!1)}},async deleteVault(){try{await u.confirm()&&(await w.remove(this.route.params.id),r.push({name:"Home"}),u.toast("Vault successfully deleted","success"))}catch(e){m.error("[Vault.vue > deleteVault]",e.message),u.toast(e.message,"error")}}}}},T=t=>(j("data-v-63d81a4c"),t=t(),F(),t),A={key:0,class:"w-100 h-100 flex-grow-1 align-items-center justify-content-center d-flex"},D=T(()=>l("div",{class:"spinner-border text-secondary"},null,-1)),H=[D],R={key:1},Y={class:"d-flex flex-column mx-3 mx-md-5 mt-5"},z={class:"d-flex justify-content-between"},q={class:"text-black"},G={key:0,class:"text-black"},J={class:"mt-5 text-black"},Q=P("Keeps "),W={key:1,class:"mt-3 mx-auto text-secondary"},X={key:2,class:"mt-3 mx-auto text-secondary"},Z={class:"masonry-with-columns"};function $(t,r,p,s,e,h){var _,f,v,g;const C=y("KeepCard"),K=y("KeepModal");return o(),n(x,null,[s.loading?(o(),n("div",A,H)):(o(),n("div",R,[l("div",Y,[l("div",z,[l("h1",q,V((_=s.vault)==null?void 0:_.name),1),s.isUsersVault?(o(),n("button",{key:0,class:"btn btn-outline-dark my-auto",onClick:r[0]||(r[0]=(...d)=>s.deleteVault&&s.deleteVault(...d))},"Delete Vault")):i("",!0)]),s.vault?(o(),n("h6",G,"Keeps: "+V((f=s.keeps)==null?void 0:f.length),1)):i("",!0),l("h1",J,[Q,t.isCurrentUser?(o(),n("i",{key:0,class:"mdi mdi-plus text-primary fs-2 action",title:"Create new keep",onClick:r[1]||(r[1]=d=>t.newItemModal(!1))})):i("",!0)]),((v=s.keeps)==null?void 0:v.length)==0?(o(),n("h1",W,"Vault has no keeps")):((g=s.filteredKeeps)==null?void 0:g.length)==0?(o(),n("h1",X,"No keeps matching search")):i("",!0),l("div",Z,[(o(!0),n(x,null,B(s.filteredKeeps,d=>(o(),S(C,{key:d.id,keep:d},null,8,["keep"]))),128))])])])),L(K,{id:"keep-modal"})],64)}var ae=N(O,[["render",$],["__scopeId","data-v-63d81a4c"]]);export{ae as default};
